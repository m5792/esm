<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
        }
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 250px;
            height: 100vh;
            background-color: #004d80;
            color: white;
            padding-top: 20px;
            overflow-y: auto;
        }
        .sidebar a {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            display: block;
            font-size: 16px;
        }
        .sidebar a:hover {
            background-color: #006699;
            border-radius: 4px;
        }
        .main-content {
            margin-left: 250px; /* Same as sidebar width */
            padding: 20px;
            width: calc(100% - 250px);
            overflow-y: auto;
            height: 100vh;
            background-color: #f4f4f4;
        }
        .content-section {
            margin-bottom: 20px;
        }
        .hidden {
            display: none;
        }

       
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <h4 class="text-center">Dashboard</h4>
        <a href="#" onclick="showContent('overview')">Home</a>
        <a href="#" onclick="showContent('ledger')"> Daybook </a>
        <a href="#" onclick="showContent('rcard')">Ration Card</a>
        <a href="#" onclick="showContent('inventory')">Ledger Report</a>
        <a href="#" onclick="showContent('afim')">A.F.I Medical</a>
        <a href="#" onclick="showReports()">ID/Password Report*</span></a>


   <br/><br/>
		            <!-- ‡§Ø‡§π ‡§è‡§ï ‡§®‡•ã‡§ü ‡§π‡•à, Dropdown URL  Script Start Heare -->
            <!DOCTYPE html>
            <html>
            <head>
            
                <script>
                    // Function to handle dropdown selection
                    function handleDropdownChange() {
                        const dropdown = document.getElementById('linkDropdown');
                        const selectedOption = dropdown.options[dropdown.selectedIndex];
            
                        if (selectedOption.value) {
                            // Open the link in a new tab
                            window.open(selectedOption.value, '_blank');
                        }
                    }
                </script>
                
            </head>
            <body>
            
                <style>
                    #linkDropdown {
                        width: 2in; /* 1 inch width */
                        padding: 5px;
                        border: 1px solid #ccc;
                        border-radius: 4px;
                        font-size: 14px;
                        background-color: white;
                        appearance: none; /* for custom styling on some browsers */
                        -webkit-appearance: none;
                        -moz-appearance: none;
                    }
                </style> 
                <select id="linkDropdown" onchange="handleDropdownChange()">
                    <option value="">--Go To Option --</option>
                    <option value="https://docs.google.com/spreadsheets/d/1C4EeSbCDaVGmJjU3QY2VNfI_IEZn0tZsqXw0ss3G58k/edit?gid=0#gid=0">	INDEX SHEET (eTally Sheet)</option>
                    <option value="https://docs.google.com/spreadsheets/d/1LJhx9QCLjinK6lvgtK32G_GwKiao5ExcrQVVHIaR-g8/edit?gid=739494111#gid=739494111">	Tally eSS (old Sheet)</option>
					 <option value="https://m5792.github.io/esm/">	MIPL Dashboard</option>
					 <option value="https://m5792.github.io/esmTally/emstools.html">	eSMTally Tools</option>
                    <option value="https://m5792.github.io/esm/DAYBOOK.html">	MIPL Daybook</option>
					<option value="https://m5792.github.io/BSA/">BSA Dashboard</option>
					 <option value="https://tathya.uidai.gov.in/access/login?role=resident"> Adhar Download, Updates</option>
					<option value="https://checkpost.parivahan.gov.in/checkpost/faces/public/payment/TaxCollection.xhtml#"> Chekpost Tax</option>
				
                </select>
            </body>
            </html>
            
            <!-- ‡§Ø‡§π ‡§è‡§ï ‡§®‡•ã‡§ü ‡§π‡•à, Dropdown URL  Script Stop Heare -->

     <br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
        <span style="color:#fcfcff;font-size:130%;font-family:Magneto;">eS |</span> 
        <span style="color:#cacacc;font-size:130%;font-family:Magneto;">MTally</span>

     

<!-- Current date and time will be displayed here -->
                    
<meta name="viewport" content="width=device-width, initial-scale=1.0">
                    
<div id="currentDateTime"  style="color:#caddf5;font-size:100%;font-family:Arial;"> </div>   
            
<script>
    function displayCurrentDateTime() {
        const now = new Date();
        
        // Formatting options
        const options = { 
            weekday: 'long', 
            year: 'numeric', 
            month: 'long', 
            day: 'numeric', 
            hour: '2-digit', 
            minute: '2-digit', 
            second: '2-digit' 
        };
        
        // Formatting date and time
        const formattedDateTime = now.toLocaleString('en-US', options);
        
        // Displaying in the div
        document.getElementById("currentDateTime").textContent = `Today: ${formattedDateTime}`;
    }

    // Call the function on page load to show the current date and time
    displayCurrentDateTime();
    
    // Update the date and time every second
    setInterval(displayCurrentDateTime, 1000);
</script>
 <!-- Current date and time will be displayed Stop -->







<!-- Reports Section (password protect script)-->
        <script>
            function showContent(sectionId) {
                // Hide all content sections
                document.querySelectorAll('.content-section').forEach((section) => {
                    section.classList.add('hidden');
                });
        
                // Show the selected content section
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.remove('hidden');
                }
            }
        
            function showReports() {
                const password = prompt("Enter the password to access ID|Password Details:");
                const correctPassword = "5792"; // Set your desired password here
        
                if (password === correctPassword) {
                    showContent('reports'); // Show the reports section
                } else if (password !== null) { // Handle Cancel case
                    alert("Incorrect password! Access denied.");
                }
            }
        </script>
        

    </div>

  
    






    <!-- Main Content -->
    <div class="main-content">
        <!-- Overview Section -->
        <div id="overview" class="content-section">
            <span style="color:#024494;font-size:120%;font-family:Arial Black;">Home </span> <br/>
            
            


            <br/>
            <span style="color:#ad2a02;font-size:130%;font-family:Arial Black;">eServices </span> |
            <span style="color:#019797;font-size:130%;font-family:Arial Black;">Stationery</span><br/>
            <i><span style="color:#808080;font-size:90%;">A Complete Online Working System</span></i><br/>
            <span style="color:#161616;font-size:90%;">Near PNB Bank Kundeshwari Kashipur (U.S.Nagar) </span><br/>
            <span style="color:#01072c;font-size:90%;">Mob: 9756735792,8057925792   |  Maill: eservicesksp@gmail.com </span>
            <br/><br/>
            
            
            
          
            
            
                    
            <!-- ‡§Ø‡§π ‡§è‡§ï ‡§®‡•ã‡§ü ‡§π‡•à, Birthday Event script Start Heare -->
            
            <div id="eventsDiv">
                <span style="color:#011b1b;font-size:120%;font-family:Arial Black;">Today's Events</span><br/>
       
        <ul id="eventsList" style="color:#024949;font-size:120%;">
            <!-- Names of students with today's events will be displayed here -->
        </ul>
    </div>
    
    
    <table id="eventsTable" style="display: none;">
        <tbody>
            <!-- Data from Google Sheets will be populated here -->
        </tbody>
    </table>
    
    <script>
        const apiKey = "AIzaSyBe-AlG9lpyXyC7KV-AavR6tbqOc75iYdM";
            const sheetId = "1cXqnV7kKebvzk6-BAuuBNSmDnpJOyCqh7LRVB6sHiL4";
            const range = 'HOLIDAY!A:J';
    
        // Fetch data from Google Sheets
        async function eventSheet() {
            try {
                const response = await fetch(
                    `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`
                );
                const data = await response.json();
    
                if (data.values) {
                    populateeventTable(data.values);
                    showTodayevents();
                } else {
                    console.error("No data found in the specified range.");
                }
            } catch (error) {
                console.error("Error fetching data from Google Sheets:", error);
            }
        }
    
        // Populate hidden table with Google Sheets data
        function populateeventTable(values) {
            const tableBody = document.querySelector("#eventsTable tbody");
            tableBody.innerHTML = ""; // Clear previous data
    
            values.forEach(row => {
                const tableRow = document.createElement("tr");
                row.forEach(cell => {
                    const tableCell = document.createElement("td");
                    tableCell.textContent = cell;
                    tableRow.appendChild(tableCell);
                });
                tableBody.appendChild(tableRow);
            });
        }
    
        // Display today's events
        function showTodayevents() {
            const today = new Date();
            const todayDate = today.getDate(); // Get today's day (6 for "6-Feb")
            const todayMonth = today.toLocaleString("en", { month: "short" }); // Get today's month abbreviation (Feb)
            
            const rows = document.querySelectorAll("#eventsTable tbody tr");
            const eventsList = document.getElementById("eventsList");
            eventsList.innerHTML = ""; // Clear previous entries
    
            rows.forEach(row => {
                const dob = row.querySelectorAll("td")[2]?.textContent; // Ensure column 10 exists (DOB)
                if (dob) {
                    // Parse DOB to match the format "6-Feb"
                    const [dobDay, dobMonth] = dob.split("-").slice(0, 2); // Extract day and month
                    const dobDayNumber = parseInt(dobDay); // Convert day to a number for comparison
    
                    if (dobDayNumber === todayDate && dobMonth === todayMonth) {
                        const eventName = row.querySelectorAll("td")[1]?.textContent || "Unknown"; // Column 4: Name
                        const date = row.querySelectorAll("td")[3]?.textContent || ""; // Column 2: Class
    
                        const listItem = document.createElement("li");
                        listItem.textContent = `${eventName}  ${date}`;
                        eventsList.appendChild(listItem);
                    }
                }
            });
        }
    
        // Load the data on page load
        //window.onload = eventSheet;
    </script>
            
            
            <!-- ‡§Ø‡§π ‡§è‡§ï ‡§®‡•ã‡§ü ‡§π‡•à,  Event script stop Here -->
            
            
            
            
            
            
            





            
            <br/> 

            <table id="lastFiveTable" border="1" style="margin-top: 20px; border-collapse: collapse;"></table>

            <span style="color: #024e5f ;font-size:120%;">Today Summry</span> 
            <div id="todaysummry">
                <span style="color: #049dbf ;font-size:100%;">Welcome to eServices l Stationery</span> &nbsp; &nbsp; | &nbsp; &nbsp;
                <span style="color: #d0070a ;font-size:100%;">Please Wait! ....</span>
            </div> 
            <div id="daybooksummry"> <span style="color: #049dbf ;font-size:100%;">Today Summry</span> </div>
               <!-- day summry div --> 

            <!-- day summry div -->
 <span style="color: #18025f ;font-size:120%;">___________________________________________________________________________________________________________________________</span> <br/>
        
 <!-- monthly summry code start -->
 
 <style>
    #monthDropdown {
        width: 1in; /* 1 inch width */
        padding: 5px;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-size: 14px;
        background-color: white;
        appearance: none; /* for custom styling on some browsers */
        -webkit-appearance: none;
        -moz-appearance: none;
    }
</style>
<div style="display: flex; align-items: center; gap: 10px;">
    <span style="color: #0b0b0b ;font-size:120%;">Monthly Summry</span> 
    <select id="monthDropdown"></select>
    <div id="monthlyTotals">Please Wait!</div>
</div>




<table id="totalMonth" border="1"></table>
<script>
   async function loadMonth() {
    const apiKey = "AIzaSyBe-AlG9lpyXyC7KV-AavR6tbqOc75iYdM";
    const sheetId = "1C4EeSbCDaVGmJjU3QY2VNfI_IEZn0tZsqXw0ss3G58k";
    const range = "DATABASE!A:L";

    try {
        const response = await fetch(
            `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`
        );
        const data = await response.json();

        if (data.values) {
            const table = document.getElementById("totalMonth");
            const monthlyData = {}; // Object to hold data for each month

            data.values.forEach((row, index) => {
                const tr = document.createElement("tr");

                if (index === 0) {
                    // Table headers
                    row.forEach((cell) => {
                        const th = document.createElement("th");
                        th.textContent = cell;
                        tr.appendChild(th);
                    });
                } else {
                    const month = getMonthFromDate(row[11]); // Get month from the date column

                    // Initialize month data if it doesn't exist
                    if (!monthlyData[month]) {
                        monthlyData[month] = { callection: 0, payment: 0, receipt: 0 , debit:0};
                    }

                    row.forEach((cell, cellIndex) => {
                        const td = document.createElement("td");
                        td.textContent = cell;
                        tr.appendChild(td);

                        // Process data based on the transaction type
                        if (cellIndex === 1) {
                            if (cell.toLowerCase() === "v" && row[4]) {
                                monthlyData[month].callection += parseFloat(row[4]) || 0;
                            } else if (cell.toLowerCase() === "p" && row[4]) {
                                monthlyData[month].payment += parseFloat(row[4]) || 0;
                            } else if (cell.toLowerCase() === "r" && row[4]) {
                                monthlyData[month].receipt += parseFloat(row[4]) || 0;
                            }

                            else if (cell.toLowerCase() === "dr" && row[4]) {
                                monthlyData[month].debit += parseFloat(row[4]) || 0;
                            }
                        }
                    });
                }
                table.appendChild(tr);
            });

            // Populate the month dropdown
            populateMonthDropdown(Object.keys(monthlyData));

            // Set initial totals for the first month
            const firstMonth = Object.keys(monthlyData)[0];
            if (firstMonth) {
                updateMonthlyTotalsDisplay(monthlyData[firstMonth]);
            }

            // Store the data globally for later use
            window.monthlyData = monthlyData;
        } else {
            console.error("No data found in the specified range.");
        }
    } catch (error) {
        console.error("Error fetching data from Google Sheets:", error);
    }
}

// Get the month-year format from the date string
function getMonthFromDate(dateStr) {
    const date = new Date(dateStr);
    const month = date.toLocaleString("default", { month: "short" }); // Get abbreviated month (Jan, Feb, etc.)
    const year = date.getFullYear(); // Get the year
    return `${month}-${year}`; // Format as "Jan-2025"
}

// Populate the dropdown with months
function populateMonthDropdown(months) {
    const dropdown = document.getElementById("monthDropdown");
    months.forEach((month) => {
        const option = document.createElement("option");
        option.value = month;
        option.textContent = month;
        dropdown.appendChild(option);
    });

    // Add event listener for the dropdown change
    dropdown.addEventListener("change", (e) => {
        const selectedMonth = e.target.value;
        updateMonthlyTotalsDisplay(window.monthlyData[selectedMonth]);
    });
}

// Update the monthly totals display
function updateMonthlyTotalsDisplay(totals) {
    const totalsElement = document.getElementById("monthlyTotals");

    // Calculate P&L (calculation - payment + receipt)
    const monthstatus = totals.callection + totals.receipt - totals.payment - totals.debit;

    // Display the totals
    totalsElement.innerHTML = `
        <span style="color: #04a4b3; font-size: 110%;">Total Callection: Rs. ${totals.callection.toFixed()}</span> |
        <span style="color: #03a745; font-size: 110%;">Total Receipt: Rs. ${totals.receipt.toFixed()}</span> |
        <span style="color: #cb5c06; font-size: 110%;">Total Payment: Rs. ${totals.payment.toFixed()}</span> |
        <span style="color: #1707ec; font-size: 110%;">Total Debit: Rs. ${totals.debit.toFixed()}</span> |
        <span style="color: black; font-size: 90%; font-family:Arial Black;">P&L: Rs. ${monthstatus.toFixed()}</span>
    `;
}

    function filterTablemonth() {
        const query = document.getElementById('searchBarmonth').value.toLowerCase();
        const table = document.getElementById('totalMonth');
        const rows = document.querySelectorAll('#totalMonth tr');
        let visibleRows = 0;
    
        rows.forEach((row, index) => {
            if (index === 0) return;
    
            const cells = row.querySelectorAll('td');
            const rowText = Array.from(cells).map(cell => cell.textContent.toLowerCase()).join(' ');
    
            if (rowText.includes(query)) {
                row.classList.remove('hidden');
                visibleRows++;
            } else {
                row.classList.add('hidden');
            }
        });
    
        table.style.display = visibleRows > 0 ? 'table' : 'none';
    
        const noResultsMessage = document.getElementById('noResultsMessage');
        if (!visibleRows && query.trim() !== '') {
            if (!noResultsMessage) {
                const message = document.createElement('p');
                message.id = 'noResultsMessage';
                message.textContent = 'No matching results found.';
                document.body.appendChild(message);
            }
        } else if (noResultsMessage) {
            noResultsMessage.remove();
        }
    }
    
   window.onload = () => {
    //     document.getElementById('totalMonth').style.display = 'none';
  // loadMonth();
    };
</script>
</body>
</html>

  <!-- monthly summry code stop -->



        </div>





        <!-- Ledger Section -->
        <div id="ledger" class="content-section hidden">
            <span style="color:#024494;font-size:120%;font-family:Arial Black;">Daybook </span>


           
            <!DOCTYPE html>
<html>
<head>
    <title>ESS Serch Bar - 291124</title>
    <style>
        /* Basic styling */
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }
        #searchContainer {
            position: sticky;
            top: 0;
            background: #f8f9fa;
            padding: 6px;
            border-bottom: 2px solid #ccc;
            z-index: 1000;
        }
        #searchBar, #dateFilter {
            padding: 5px;
            margin: 5px 0;
            width: 30%;
            box-sizing: border-box;
            border: 2px solid #d4ac0d ;
            border-radius: 4px;
        }
        #totals, #difference {
            padding: 10px;
            border-bottom: 2px solid #ccc;
            font-weight: bold;
        }
        #totals {
            background: #eff5fa;
            color: rgb(20, 20, 20);
	        font-size: 14px;
        }
        #difference {
            background: #014c92;
            color: white;
        }
        #printButton {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px;
            background: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 4px;
        }
        #printButton:hover {
            background: #0056b3;
        }
        table {
                width: 100%;
                border-collapse: collapse;
                box-shadow: 0 0 15px rgba(0,0,0,0.1);
                background-color: #fff;
                margin-top: 20px;
                border-radius: 10px;
                overflow: hidden;
                font-size: 12px;
            }
    
            th, td {
                padding: 12px;
                border: 1px solid #ddd;
                text-align: center;
            }
    
            th {
                background: #0077b6;
                color: white;
                font-weight: bold;
            }
    
            tr:nth-child(even):not([style*="display: none"]) {
                background: na;
            }
    
            tr:hover {
                background-color: #ffe066;
            }

        
        tr.hidden {
            display: none;
        }
        tr.blue {background:  #fca1a1 ;
            color: #070707;
        }
        tr.red {background:  #a7f8cd ;
            color: #0a0a0a ;
        }

	tr.yellow {
            color: #c38004 ;
        }

        tr.p {
            color: #c31104 ;
        }

        tr.r {
            color: #048d2d ;
        }

        tr.msaf {background:  rgb(155, 221, 252) ;
            color: #030b77 ;
        }

        #myTable.hidden {
            display: none;
        }
        table {
            overflow-x: auto;
            display: block;
        }

        /* Print-specific styles */
        @media print {
            body {
                font-family: "Times New Roman", serif;
                background-color: #fff;
                padding: 0;
            }
            #searchContainer, #printButton {
                display: none;
            }
            #totals, #difference {
                font-size: 18px;
                margin-bottom: 10px;
            }
            table, th, td {
                border: 1px solid #000;
                border-collapse: collapse;
            }
            th, td {
                padding: 10px;
                text-align: left;
                font-size: 14px;
            }
            tr.hidden {
                display: table-row;
            }
        }

        
        /* ‡§Ø‡§π ‡§è‡§ï ‡§®‡•ã‡§ü ‡§π‡•à, Highlight the search value colour in table */
        .highlight {
        background-color: rgb(247, 244, 121);
        font-weight: bold;
    }
    </style>
    <script>

let latestEntry = []; // Global array to store all entries
         async function loadSheet() {
            const apiKey = "AIzaSyBe-AlG9lpyXyC7KV-AavR6tbqOc75iYdM";
            const sheetId = "1C4EeSbCDaVGmJjU3QY2VNfI_IEZn0tZsqXw0ss3G58k";
            const range = 'DATABASE!A:L';

            try {
                const response = await fetch(
                    `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`
                );
                const data = await response.json();

                if (data.values) {
                     // Clear the table before reloading data
                    const table = document.getElementById('myTable');
                    table.innerHTML = ""; // Clear existing table content
                    
                    latestEntry = data.values.slice(); // Store full data
                    showLastFiveEntries(); // Show last 5 in separate table


// Populate the table

                    data.values.forEach((row, index) => {
                        const tr = document.createElement('tr');

                        if (index === 0) {
                            row.forEach((cell) => {
                                const th = document.createElement('th');
                                th.textContent = cell;
                                tr.appendChild(th);
                            });
                        } else {
                            row.forEach((cell, cellIndex) => {
                                const td = document.createElement('td');
                                td.textContent = cell;
                                tr.appendChild(td);

                                // Apply styles based on Type column
                                if (cellIndex === 2) {
                                    if (cell.toLowerCase() === "opening") {
                                        tr.classList.add('blue');
                                    } else if (cell.toLowerCase() === "closing") {
                                        tr.classList.add('red');
                                    }	

                                }


                                if (cellIndex === 7) {
                                    if (cell.toLowerCase() === "msaf") {
                                        tr.classList.add('msaf');
                                    }

                                }

                                if (cellIndex === 1) {
                                    if (cell.toLowerCase() === "r") { // yha par "r" matlab receipt table ke 1 no colums ki value
                                        tr.classList.add('r');  // yha par "r" matlab receipt colour uper define hai
                                    } else if (cell.toLowerCase() === "p") {  // yha par "p" matlab receipt table ke 1 no colums ki value
                                        tr.classList.add('p');  // yha par "p" matlab payment colour uper define hai
                                    }	
                                   
                                }
                            });
                        }
                        table.appendChild(tr);
                    });


                    // Set today's date in the date filter
                setTodayDate();

// Apply the filter automatically for today's date
filterTable();



                    calculateTotals(); // Calculate totals initially
                } else {
                    console.error("No data found in the specified range.");
                }
            } catch (error) {
                console.error("Error fetching data from Google Sheets:", error);
            }
        }




        function calculateTotals() {
            const rows = document.querySelectorAll('#myTable tr:not(.hidden)');
            let totalInvoice = 0;
            
            let totalBankInvoice = 0;
            let totalTdsInvoice = 0;
		let totalReceipt = 0;
        let totalUdhar = 0;

        let totalOpening = 0;
            let totalClosing = 0;


            rows.forEach((row, index) => {
                if (index === 0) return; // Skip header row
                const cells = row.querySelectorAll('td');
                const invoiceAmount = parseFloat(cells[6]?.textContent || "0");
                const weight = parseFloat(cells[6]?.textContent || "0");
                const type = cells[1]?.textContent.toLowerCase();
                const bankInvoice = parseFloat(cells[4]?.textContent || "0");
                const tdsInvoice = parseFloat(cells[4]?.textContent || "0");

                const voucherType = cells[2]?.textContent.toLowerCase();
                let rowTotal = 0;

		const receipt = parseFloat(cells[4]?.textContent || "0");
        const udhar = parseFloat(cells[5]?.textContent || "0");

               // if (!isNaN(invoiceAmount)) totalInvoice += invoiceAmount;
               if (type === "v" && !isNaN(invoiceAmount)) totalInvoice += invoiceAmount;
                if (type === "v" && !isNaN(bankInvoice)) totalBankInvoice += bankInvoice;
                if (type === "p" && !isNaN(tdsInvoice)) totalTdsInvoice += tdsInvoice;
		if (type === "r" && !isNaN(receipt)) totalReceipt += receipt;
        if (type === "v" && !isNaN(receipt)) totalUdhar += udhar;



           // Sum columns 3 to 9
           for (let i = 3; i <= 9; i++) {
                    const value = parseFloat(cells[i]?.textContent || "0");
                    if (!isNaN(value)) rowTotal += value;
                }

                // Add to appropriate totals
                if (voucherType === "opening") {
                    totalOpening += rowTotal;
                } else if (voucherType === "closing") {
                    totalClosing += rowTotal;
                }



            });

            document.getElementById('totalInvoice').textContent = totalInvoice.toFixed();
           
            document.getElementById('totalBankInvoice').textContent = totalBankInvoice.toFixed();
            document.getElementById('totalTdsInvoice').textContent = totalTdsInvoice.toFixed();
		document.getElementById('totalReceipt').textContent = totalReceipt.toFixed();
        document.getElementById('totalUdhar').textContent = totalUdhar.toFixed();


        document.getElementById('totalOpening').textContent = totalOpening.toFixed();
            document.getElementById('totalClosing').textContent = totalClosing.toFixed();

            const difference = totalBankInvoice + totalReceipt - totalTdsInvoice - totalUdhar;

            const opnCls = totalClosing - totalOpening ;
            const accDiff = opnCls - difference ;

            document.getElementById('difference').textContent = `Total Callection Rs.${difference.toFixed()} | O/C Diff : Rs.${opnCls.toFixed()} | A/C Diff : Rs.${accDiff.toFixed()} `;
       
            document.getElementById('todaysummry').innerHTML = `Total Callection Rs.${difference.toFixed()} | O/C Diff : Rs.${opnCls.toFixed()} | <span style="color: #0444b3 ;font-size:90%; font-family:Arial Black;">A/C Diff : Rs.  ${accDiff.toFixed()}</span>   `;
       

            document.getElementById('daybooksummry').innerHTML = `
            <span style="color: #039074 ;font-size:100%;">Total Transection Amt:</span>     Rs.    ${totalInvoice.toFixed()} |
            <span style="color: #04a4b3 ;font-size:100%;">Callection (V):</span>            Rs.    ${totalBankInvoice.toFixed()}    |
            <span style="color: #cb5c06 ;font-size:100%;">Payment (P):</span>               Rs.     ${totalTdsInvoice.toFixed()} 	|
            <span style="color: #03a745 ;font-size:100%;">Receipt (R):</span>               Rs.     ${totalReceipt.toFixed()}     |
            <span style="color: #1707ec ;font-size:100%;">DR. (Udhar):</span>               Rs.     ${totalUdhar.toFixed()}             |
            <span style="color: #FF0000 ;font-size:100%;">Opening (B):</span>               Rs.     ${totalOpening.toFixed()}   |
            <span style="color: #03b51b ;font-size:100%;">Closing (C):</span>               Rs.     ${totalClosing.toFixed()}  
            
             `; 
        }

// by default set today entry filter
        function setTodayDate() {
        const today = new Date();
        const yyyy = today.getFullYear();
        const mm = String(today.getMonth() + 1).padStart(2, '0'); // Months are 0-indexed
        const dd = String(today.getDate()).padStart(2, '0');
        const todayDate = `${yyyy}-${mm}-${dd}`;
        document.getElementById('dateFilter').value = todayDate; // Set the value in the date input
    }


        function formatDate(inputDate) {
            const date = new Date(inputDate);
            const months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
            const day = String(date.getDate()).padStart(1, '0');
            const month = months[date.getMonth()];
            const year = date.getFullYear();
            return `${day}-${month}-${year}`;
        }

        function filterTable() {
    const query = document.getElementById('searchBar').value.toLowerCase();
    const selectedDate = document.getElementById('dateFilter').value;
    const formattedDate = selectedDate ? formatDate(selectedDate) : null;
    const rows = document.querySelectorAll('#myTable tr');

    rows.forEach((row, index) => {
        if (index === 0) return; // Skip header row

        const cells = row.querySelectorAll('td');
        const rowText = Array.from(cells).map(cell => cell.textContent.toLowerCase()).join(' ');
        const rowDate = cells[11]?.textContent;
        let isVisible = true;

        // Remove previous highlights
        cells.forEach(cell => {
            cell.innerHTML = cell.textContent; // Reset any highlights
        });

        // Priority: Search Bar
        if (query.trim() !== '') {
            isVisible = rowText.includes(query);

            // Highlight the search term within the row if visible
            if (isVisible) {
                cells.forEach(cell => {
                    const cellText = cell.textContent;
                    const regex = new RegExp(`(${query})`, 'gi');
                    const highlightedText = cellText.replace(regex, '<span class="highlight">$1</span>');
                    cell.innerHTML = highlightedText; // Apply highlighting
                });
            }
        } else if (formattedDate) {
            // Filter by date only if search bar is empty
            isVisible = rowDate === formattedDate;
        }

        // Toggle visibility based on filter logic
        row.classList.toggle('hidden', !isVisible);
    });

    calculateTotals(); // Recalculate totals after filtering

    // Show or hide the table based on results
    const visibleRows = Array.from(rows).some((row, index) => index > 0 && !row.classList.contains('hidden'));
    const table = document.getElementById('myTable');
    table.classList.toggle('hidden', !visibleRows);
}


//  show last five entry code start

  // table.innerHTML = ""; // Clear existing table content
//   latestEntry = data.values.slice(); // Store full data
//   showLastFiveEntries(); // Show last 5 in separate table
// ******** note: uper ke tino code ko loaddatasheet function me add karna hai 

function showLastFiveEntries() {
    const table = document.getElementById('lastFiveTable');
    table.innerHTML = ""; // Clear previous content

    if (latestEntry.length > 1) {
        // Add header row
        const headerRow = document.createElement('tr');
        latestEntry[0].forEach(cell => {
            const th = document.createElement('th');
            th.textContent = cell;
            th.style.backgroundColor = '#006699';
            th.style.color = 'white';
            headerRow.appendChild(th);
        });
        table.appendChild(headerRow);

        // Get top 5 entries (excluding header)
        const dataRows = latestEntry.slice(1); // Exclude header
        const topFive = dataRows.slice(0, 5);   // First 5 entries from top

        // Display in top-down order
        topFive.forEach(row => {
            const tr = document.createElement('tr');

            // Conditional coloring
            const col2 = row[1]?.toLowerCase(); // column 2
            const col3 = row[2]?.toLowerCase(); // column 3

            if (col3 === 'opening') {
              //  tr.style.backgroundColor = '#ffcccc'; // light red
                tr.style.color = 'red';
            } else if (col3 === 'closing') {
              //  tr.style.backgroundColor = '#ccffcc'; // light green
                tr.style.color = 'green';
            }

            if (col2 === 'p') {
                // tr.style.backgroundColor = '#cce5ff'; // light blue overrides others
                tr.style.color = 'blue';
            }

            row.forEach(cell => {
                const td = document.createElement('td');
                td.textContent = cell;
                td.style.padding = "6px 10px";
                tr.appendChild(td);
            });
            table.appendChild(tr);
        });
    }
}

//  show last five entry code stop

        function printTable() {
            const table = document.getElementById('myTable');
            const filteredRows = Array.from(table.querySelectorAll('tr')).filter(row => {
                return !row.classList.contains('hidden');
            });

            const printContent = `


             <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 12px; text-align: left; }
                        table th, table td { border: 1px solid #ddd; padding: 5px; }
                        table th { background-color: #f4f4f4; font-weight: bold; }
                        table tr.payment { background-color: white; color: BLACK; }
                        table tr.receipt { background-color: BLAC; color: red; }
                        table tr.bill { background-color: BLAC; color: blue; }
                    </style>



                <div style="text-align:center; font-size:20px; font-weight:bold;">
                    ESS Ledger Report
                </div>
                <div>
                    ${document.getElementById('totals').outerHTML}
                    ${document.getElementById('difference').outerHTML}
                </div>
                <table>
                    ${filteredRows.map(row => row.outerHTML).join('')}
                </table>
            `;
            const printWindow = window.open('', '', 'height=500,width=800');
            printWindow.document.write('<html><head><title>Print</title>');
            printWindow.document.write('</head><body>');
            printWindow.document.write(printContent);
            printWindow.document.write('</body></html>');
            printWindow.document.close();
            printWindow.print();
        }

 //  setInterval(loadSheet, 5000);

        window.onload = () => {
            loadSheet();
            document.getElementById('searchBar').addEventListener('input', filterTable);
            document.getElementById('dateFilter').addEventListener('change', filterTable);
            document.getElementById('printButton').addEventListener('click', printTable);

//
eventSheet();
//
            // monthly summry
            document.getElementById('totalMonth').style.display = 'none';
   loadMonth();
   //


     // Hide table initially M1000
     document.getElementById('m1000lTable').style.display = 'none';
// Load data and set up search
M1000();
document.getElementById('inputArea').addEventListener('input', serchProfile);
//
        };
    </script>
</head>
<body>
    <div id="difference">
        <span style="color: #049dbf ;font-size:100%;">Welcome to eServices l Stationery</span> &nbsp; &nbsp; | &nbsp; &nbsp;
        <span style="color: #d0070a ;font-size:100%;">Please Wait! ....</span>
    </div>

    <div id="searchContainer">
        <input type="text" id="searchBar" placeholder="Search for Ledger, Job No., Vehicle No.,Narration.." />
        <input type="date" id="dateFilter" />
        <button onclick="loadSheet()">Refresh</button>

        <div id="totals">
            <span style="color: #039074 ;font-size:100%;">Total Transection Amt:</span>  Rs.<span id="totalInvoice">0.00</span> |
        
            <span style="color: #0a04b3 ;font-size:100%;">Callection (V):</span>            Rs.<span id="totalBankInvoice">0.00</span> |
            <span style="color: #cb5c06 ;font-size:100%;">Payment (P):</span>               Rs.<span id="totalTdsInvoice">0.00</span>		|
            <span style="color: #03a745 ;font-size:100%;">Receipt (R):</span>               Rs.<span id="totalReceipt">0.00</span> |
            <span style="color: #1707ec ;font-size:100%;">DR. (Udhar):</span>                  Rs.<span id="totalUdhar">0.00</span> |
        <span style="color: #FF0000 ;font-size:100%;">Opening (B):</span>                   Rs.<span id="totalOpening">0.00</span> |
        <span style="color: #03b51b ;font-size:100%;">Closing (C):</span>                   Rs.<span id="totalClosing">0.00</span>

        </div>
<button id="printButton">Print</button>
    </div>



    <table id="myTable" >
        <!-- Table will be dynamically populated -->
    </table>
</body>
</html>

<br/><br/><br/><br/><br/><br/>





        </div>

        <!-- ration Card  Section Start -->
        <div id="rcard" class="content-section hidden">
            <span style="color:#024494;font-size:120%;font-family:Arial Black;">Ration Card </span> <br/>


            <input type="text" id="searchInput" placeholder="Search By Ration Card No. Name, Last 4 Digit Adhar & Mobail...." onkeyup="rationcardsearch()" style="font-size:18px; padding:5px; width:650px;">
<div id="results"></div>

<script>
const apiRCKey = "AIzaSyBe-AlG9lpyXyC7KV-AavR6tbqOc75iYdM";
const sheetRCId = "1E9bwBJjHRo1DhUSNayuJ2j62ilqILvMzBvf3TrQGA9s";

let allData = [];  // { sheet, header, row }

// ‚úÖ Step 1: Get all sheet names
async function rationcardsheets() {
    const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetRCId}?key=${apiRCKey}`;
    const res = await fetch(url);
    const data = await res.json();
    return data.sheets.map(s => s.properties.title);
}

// ‚úÖ Step 2: Load all sheets data (header + rows)
async function loadAllData() {
    const sheetNames = await rationcardsheets();
    for (let name of sheetNames) {
        // Get header (Row 1)
        const headerUrl = `https://sheets.googleapis.com/v4/spreadsheets/${sheetRCId}/values/${encodeURIComponent(name + "!A1:Z1")}?key=${apiRCKey}`;
        const headerRes = await fetch(headerUrl);
        const headerData = await headerRes.json();
        const headerRow = headerData.values ? headerData.values[0] : [];

        // Get data rows (From A2)
        const range = `${name}!A2:Z`;
        const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetRCId}/values/${encodeURIComponent(range)}?key=${apiRCKey}`;
        const res = await fetch(url);
        const data = await res.json();

        if (data.values) {
            data.values.forEach(row => {
                allData.push({ sheet: name, header: headerRow, row });
            });
        }
    }
    console.log("All data loaded:", allData);
}

// ‚úÖ Step 3: Search with Highlight + Show Header Once
function rationcardsearch() {
    const query = document.getElementById("searchInput").value.toLowerCase();
    const resultsDiv = document.getElementById("results");
    resultsDiv.innerHTML = "";

    if (query.trim() === "") return;

    const filtered = allData.filter(item =>
        item.row.some(cell => cell.toLowerCase().includes(query))
    );

    if (filtered.length === 0) {
        resultsDiv.innerHTML = "<p>No results found</p>";
        return;
    }

    let lastSheet = "";

    filtered.forEach(item => {
        // Show header if sheet changes
        if (lastSheet !== item.sheet) {
            const headerDiv = document.createElement("div");
            headerDiv.style.backgroundColor = "#f0f0f0";
            headerDiv.style.fontWeight = "bold";
            headerDiv.style.padding = "5px";
            headerDiv.innerHTML = `<b>${item.sheet}</b> ‚Üí ${item.header.join(" | ")}`;
            resultsDiv.appendChild(headerDiv);
            lastSheet = item.sheet;
        }

        // Highlight match
        const highlightedRow = item.row.map(cell => {
            if (cell.toLowerCase().includes(query)) {
                const regex = new RegExp(`(${query})`, "gi");
                return cell.replace(regex, `<span style="background-color:blue; color:white;">$1</span>`);
            }
            return cell;
        });

        // Add result row
        const div = document.createElement("div");
        div.style.padding = "5px";
        div.style.borderBottom = "1px solid #ccc";
        div.innerHTML = highlightedRow.join(" | ");
        resultsDiv.appendChild(div);
    });
}

// ‚úÖ Start
loadAllData();
</script>

          
 </div>  <!-- ration Card  Section Start -->

        <!-- Inventory Section -->
        <div id="inventory" class="content-section hidden">
            <span style="color:#024494;font-size:120%;font-family:Arial Black;">LEDGER REPORT </span> <br/>

            <iframe src="LEDGER REPORT.html" width="100%" height="750"></iframe>
        </div>


         <div id="afim" class="content-section hidden">
            <span style="color:#024494;font-size:120%;font-family:Arial Black;">A.F.I Medical- Medicine Serch </span> <br/>

            <div id="searchAFIM">
                <input type="text" id="inputAFIMArea" placeholder="Search User ID/Password, Atm, Credit Details, Adhar card, PAN Card and Many More ..." />
            </div>


             <!-- üìã Data Table -->
    <table id="AFIMlTable"></table>

        </div>



        <!-- Reports Section (password protect)-->
        <div id="reports" class="content-section hidden">
            <span style="color:#024494;font-size:120%;font-family:Arial Black;">ID/Password Report </span> <br/>


            <div id="searchDiv">
                <input type="text" id="inputArea" placeholder="Search User ID/Password, Atm, Credit Details, Adhar card, PAN Card and Many More ..." />
            </div>
            
            <!-- ‡§Ø‡§π ‡§è‡§ï ‡§®‡•ã‡§ü ‡§π‡•à, M1000Table show div hare -->
            
            <table id="m1000lTable">
            <!-- Table will be dynamically populated -->
            </table>
            <!-- ‡§Ø‡§π ‡§è‡§ï ‡§®‡•ã‡§ü ‡§π‡•à, M1000Table show div  -->
            

            </div>
            


























































  



















<!-- ‡§Ø‡§π ‡§è‡§ï ‡§®‡•ã‡§ü ‡§π‡•à, E03 - Footer Start Heare -->


<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
.footer {position: fixed;left: 0;bottom: 0;width: 100%;background-color:#013558;color: black;text-align:LEFT;}
</style></head>
<body>
<div class="footer">




    <!-- ‡§Ø‡§π ‡§è‡§ï ‡§®‡•ã‡§ü ‡§π‡•à, FOOTER CONTENT START hare -->



<table style="background-color:#01243b; color:WHITE; ">


 
<td style="background-color:black;text-align: center; color:WHITE;">
    <a href="https://www.google.co.in/" target="_blank"><img src="https://cdn.dribbble.com/users/1717214/screenshots/4124610/g-logo.gif" alt="Gmail" width="50" height="50" /></a>
    </td>
    <td style="background-color:black;text-align: center; color:WHITE;">
    <a href="https://b2b.spicemoney.com/loginPageLogin.action" target="_blank"><img src="https://i.pinimg.com/564x/b7/20/da/b720da5201bbf48862018c83e7925a8a.jpg" alt="Gmail" width="60" height="60" /></a>
    </td>
    <td style="background-color:black;text-align: center; color:WHITE;">
        <a href="https://web.travelunion.in/irctc_search_screen" target="_blank"><img src="https://www.travelunion.in/img/svg/travel-union-know-us.svg" alt="Gmail" width="60" height="60" /></a>
        </td>
    <td style="background-color:black;text-align: center; color:WHITE;">
    <a href="https://mail.google.com/mail/u/0/" target="_blank"><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSjpEIz6vZxfKx_cLh8Y6tDWalIuwi08MCggUEXk8cXLAy8NUilIHwNgrsjtFIxgEWCWAE&usqp=CAU" alt="You Tube" width="50" height="50" /></a>
    </td>
    <td style="background-color:black;text-align: center; color:WHITE;">
    <a href="https://netpnb.com/" target="_blank"><img src="https://cracku.in/latest-govt-jobs/wp-content/uploads/2021/01/PNB-Logo.png" alt="Google" width="50" height="50" /></a>
    </td>
    <td style="background-color:black;text-align: center; color:WHITE;">
    <a href="https://retail.onlinesbi.sbi/retail/login.htm" target="_blank"><img src="https://image3.mouthshut.com/images/ImagesR/2015/12/State-Bank-Anywhere-925771560-7182350-1.png" width="50" height="50" /></a>
    </td>
    <td style="background-color:WHITE;text-align: center; color:WHITE;">
    <a href="https://netbanking.hdfcbank.com/netbanking/"  target="_blank"><img src="https://p.kindpng.com/picc/s/284-2843275_online-donation-shri-ramakrishna-ashrama-rajkot-using-hdfc.png" alt="You Tube" width="50" height="50" /></a>
    </td>
    
    <td style="background-color:black;text-align: center; color:WHITE;">
    <a href="https://www.youtube.com/" target="_blank"><img src="http://3d-sprinter.ru/pictures/youtube256-2-on.gif" alt="You Tube" width="50" height="50" /></a>
    </td>
    
    <td style="background-color:black;text-align: center; color:WHITE;">
    <a href="https://www.facebook.com/" target="_blank"><img src="https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExNTZuaHQ1ZjdnajNwMWtrZHVhN3Q4djdwMDZmYWZuYzRoYTA0Ymx4MiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/IeRI0TleieCJ6ytPUr/giphy.gif" alt="You Tube" width="50" height="50" /></a>
     </td>
    
    <td style="background-color:black;text-align: center; color:WHITE;">
      <a href="https://web.whatsapp.com/" target="_blank"><img src="https://cliply.co/wp-content/uploads/2021/08/372108180_WHATSAPP_ICON_400.gif" alt="You Tube" width="50" height="50" /></a>
        </td>



</table>










</div></body>

<!-- ‡§Ø‡§π ‡§è‡§ï ‡§®‡•ã‡§ü ‡§π‡•à, E03 - Footer Stop Heare -->












<!-- ‡§Ø‡§π ‡§è‡§ï ‡§®‡•ã‡§ü ‡§π‡•à, Password Protuct Prompt  Script Start Heare -->
<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Input Validation Example</title>
    <script>
        function getUserInput() {
            let userInput;

            // Loop chalega jab tak valid input nahi milta
            while (true) {
                userInput = prompt("Enter Your Login Password");

                // Agar user cancel karta hai, toh phir bhi prompt dikhate hain
                if (userInput === null) {
                    alert("Please Password First. Do't Cancel");
                } else if (userInput ==2025) {
                    // Agar input valid hai
                    alert("Login Successful.  Welcome Mr. Mukhtiyar Ahamad");
                    break; // Loop se bahar nikalte hain
                } else {
                    alert("Wrong Password, Enter Correct Password");
                }
            }
        }

        // Page load hone par function ko auto start karna
       // window.onload = getUserInput;
    </script>
</head>

</html>



























 <!-- ‡§Ø‡§π ‡§è‡§ï ‡§®‡•ã‡§ü ‡§π‡•à, M1000 - ID/PASWORD OTHER DETAILS Start Heare -->

 <!DOCTYPE html>
 <html>
 <head>
     <title>ID | PASSWORD ESS</title>
     <style>
         body {
             margin: 0;
             font-family: Arial, sans-serif;
         }
         #searchDiv {
             position: sticky;
             top: 0;
             background: #f8f9fa;
             padding: 10px;
             border-bottom: 2px solid #ccc;
             z-index: 1000; /* Ensure it stays above the table */
         }
         #inputArea {
             padding: 8px;
             width: 100%;
             box-sizing: border-box;
             border: 2px solid #ccc;
             border-radius: 4px;
         }
         tr.hidden {
             display: none;
         }
         #noResultsMessage {
             text-align: center;
             margin-top: 10px;
         }
 
        
         /* ‡§Ø‡§π ‡§è‡§ï ‡§®‡•ã‡§ü ‡§π‡•à, Highlight the search value colour in table */
         .highlight {
     background-color: rgb(21, 215, 241);
     font-weight: bold;
 }
     </style>
     <script>
        async function M1000() {
            const apiKey = "AIzaSyBe-AlG9lpyXyC7KV-AavR6tbqOc75iYdM";
            const sheetId = "1EOO0QzwNaPhwIfZN_DCLlhQB9yeC-j-GpmtM_6JMRmw";
            const range = 'PASSWORD!A:E';

            try {
                const response = await fetch(
                    `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`
                );
                const data = await response.json();

                if (data.values) {
                    const table = document.getElementById('m1000lTable');
                    table.innerHTML = ''; // Clear existing table content

                    data.values.forEach((row, index) => {
                        const tr = document.createElement('tr');

                        if (index === 0) {
                            // Header row
                            row.forEach((cell) => {
                                const th = document.createElement('th');
                                th.textContent = cell;
                                tr.appendChild(th);
                            });
                        } else {
                            // Data rows
                            row.forEach((cell, cellIndex) => {
                                const td = document.createElement('td');

                                // Check if the cell contains a URL and create a clickable link
                                if (typeof cell === 'string' && (cell.startsWith('http') || cell.startsWith('www'))) {
                                    const a = document.createElement('a');
                                    a.href = cell.startsWith('http') ? cell : `http://${cell}`; // Add http:// if missing
                                    a.innerHTML = "&#128221; Click to View PO"; // Use icon as link text
                                    a.target = "_blank";
                                    td.appendChild(a);
                                } else {
                                    td.textContent = cell;
                                }

                                // Highlight row based on column value
                                if (cellIndex === 0) {
                                    if (cell.toLowerCase() === "credit note") {
                                        tr.classList.add('blue');
                                    } else if (cell.toLowerCase() === "bank") {
                                        tr.classList.add('red');
                                    }
                                }

                                tr.appendChild(td);
                            });
                        }
                        table.appendChild(tr);
                    });
                } else {
                    console.error("No data found in the specified range.");
                }
            } catch (error) {
                console.error("Error fetching data from Google Sheets:", error);
            }
        }

        function serchProfile() {
            const query = document.getElementById('inputArea').value.toLowerCase();
            const table = document.getElementById('m1000lTable');
            const rows = document.querySelectorAll('#m1000lTable tr');
            let visibleRows = 0; // Track the number of visible rows

            rows.forEach((row, index) => {
                if (index === 0) return; // Skip header row

                // Remove previous highlights
                row.querySelectorAll('td').forEach(cell => {
                    cell.innerHTML = cell.textContent; // Reset any highlights
                });

                if (query.trim() === '') {
                    row.classList.add('hidden'); // Hide all rows if search bar is blank
                } else {
                    const cells = row.querySelectorAll('td');
                    const rowText = Array.from(cells).map(cell => cell.textContent.toLowerCase()).join(' ');

                    if (rowText.includes(query)) {
                        row.classList.remove('hidden');
                        visibleRows++;

                        // Highlight the search term within the row
                        cells.forEach(cell => {
                            const cellText = cell.textContent;
                            const regex = new RegExp(`(${query})`, 'gi');
                            const highlightedText = cellText.replace(regex, '<span class="highlight">$1</span>');
                            cell.innerHTML = highlightedText; // Apply highlighting
                        });
                    } else {
                        row.classList.add('hidden');
                    }
                }
            });

            // Show the table if there are visible rows
            if (visibleRows > 0) {
                table.style.display = 'table';
            } else {
                table.style.display = 'none';
            }

            // Display a message if no rows are visible
            const noResultsMessage = document.getElementById('noResultsMessage');
            if (!visibleRows && query.trim() !== '') {
                if (!noResultsMessage) {
                    const message = document.createElement('p');
                    message.id = 'noResultsMessage';
                    message.textContent = 'No matching results found.';
                    document.body.appendChild(message);
                }
            } else if (noResultsMessage) {
                noResultsMessage.remove();
            }
        }

       // window.onload = () => {
            // Hide table initially
         //   document.getElementById('m1000lTable').style.display = 'none';

            // Load data and set up search
           //   M1000();
        //    document.getElementById('inputArea').addEventListener('input', serchProfile);
        //   };
    </script>
 </head>
 <body>
     
 
    <!-- ‡§Ø‡§π ‡§è‡§ï ‡§®‡•ã‡§ü ‡§π‡•à, multitab ke contain 3 me hai serch aur table likhi hai -->
     
    
 </body>
 </html>
 <!-- ‡§Ø‡§π ‡§è‡§ï ‡§®‡•ã‡§ü ‡§π‡•à, M1000 - ID/PASWORD OTHER DETAILS Start Heare -->

















































<!-- floating DROPDOWN OPTION-btn WITH FORM FORM form div script START hare -->
 <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>es|Mtally</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }

    .floating-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #007bff;
      color: white;
      padding: 12px 18px;
      border: 5px solid #004d80;
      border-radius: 50%;
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      z-index: 1000;
    }

    .floatingdropdown {
      position: fixed;
      bottom: 70px;
      right: 20px;
      background-color: #bde2fa;
      border: 5px solid #004d80;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      display: none;
      z-index: 1000;
      color: black;
    }

    .floatingdropdown button {
      background: none;
      border: none;
      padding: 2px 8px;
      width: 100%;
      text-align: justify;
      cursor: pointer;
    }

    .floatingdropdown button:hover {
      background-color: #81c3ee;
      color: rgb(247, 244, 244);
    }

    .form-container {
      position: fixed;
      top: 50px;
      right: 20px;
      width: 4in;
      height: 7.8in;
      background-color: #dddedf;
      border: 5px solid #004d80;
      padding: 10px;
      display: none;
      z-index: 99;
      overflow-y: auto;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      border-radius: 8px;
    }

    .form-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .form-header h3 {
      margin: 0;
      font-size: 18px;
    }

    .close-btn {
      background: none;
      border: none;
      font-size: 18px;
      cursor: pointer;
      color: #555;
    }

    .close-btn:hover {
      color: red;
    }






    
           /* Form Inputs */
input, select {
    width: 100%;
    padding: 6px;
    margin-bottom: 15px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 16px;
    box-sizing: border-box;
}

/* Light Gray Background for Inputs */
input[type="text"], input[type="number"], input[type="date"], select {
    background-color: #f9f9f9;
}

/* Submit and Button Styling */
input[type="submit"] {
    background-color: #080808;
    color: rgb(246, 246, 248);
    font-weight: bold;
    border: none;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.2s ease;
}

input[type="submit"]:hover, button:hover {
    background-color: #575555;
    transform: translateY(-2px);
}

/* Dropdown Styling */
.dropdown-container {
    position: relative;
    text-align: left;
}         
            /* Dropdown styling */
            #ledgerDropdown {
              display: none;
              position: absolute;
              background-color: rgb(12, 1, 1);
              color: rgb(245, 239, 239);
              width: 30%;
              border: 1px solid #ccc;
              border-radius: 8px;
              max-height: 150px;
              overflow-y: auto;
              box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
              margin-top: 5px;
              z-index: 10;
            }
        
            #ledgerDropdown li {
              padding: 10px;
              cursor: pointer;
              transition: background-color 0.3s ease;
            }
        
            #ledgerDropdown li:hover {
              background-color: #01534d;
            }



  </style>
</head>
<body>

  <!-- Floating Button -->
  <button class="floating-btn" onclick="toggleDropdown()">+</button>

  <!-- Dropdown Menu -->
  <div class="floatingdropdown" id="dropdownMenu">
    <button onclick="showForm('banking')" style="color: black;">Banking</button>
    <button onclick="showForm('voucher')"style="color: black;">Voucher</button>
    <button onclick="showForm('payment')"style="color: black;">Payment</button>
    <button onclick="showForm('receipt')"style="color: black;">Receipt</button>
    <button onclick="showForm('journal')"style="color: black;">Journal</button>
   
  </div>

  <!-- Right Form Section -->
  <div class="form-container" id="formContainer">
    <div class="form-header">
      <h3 id="formTitle"></h3>
      <button class="close-btn" onclick="closeForm()">‚úï</button>
    </div>
    <div id="formContent">
      <!-- Form will be injected here -->
    </div>
  </div>

  <script>
    function toggleDropdown() {
      const floatingdropdown = document.getElementById("dropdownMenu");
      floatingdropdown.style.display = floatingdropdown.style.display === "block" ? "none" : "block";
    }
 
    function showForm(type) {
      const titleMap = {
        banking: "Banking",
        voucher: "Voucher",
        receipt: "Receipt",
        journal: "Journal",
        payment: "Payment"
      };
      
      const contentMap = {
        banking: `
    <div>
     
 <form id="mainBANKForm">
        <input type="hidden" name="SNo" id="sNo">
        

        <label for="type"></label>
        <select id="msaf1" name="Type" style="color: #6803a2 ;font-size:100%;" required>
            <option value="B">Banking</option>
            <option value="Abst">Journal</option>
        </select>

        <label for="voucher"></label>
        <select id="msaf2" name="Voucher" required>
            <option value="" disabled selected>--Select O/C--</option>
            <option value="OPENING">OPENING</option>
            <option value="CLOSING">CLOSING</option>
        </select>

        <input type="number" id="msaf3" name="esmA" placeholder="Cash in Hand" required>
        <input type="number" id="msaf4" name="esmB" placeholder="PNB-437" required>
        <input type="number" id="msaf5" name="esmC" placeholder="PNB-683" required>
        <input type="number" id="msaf6" name="esmD" placeholder="SBI-2755" required>
        <input type="number" id="msaf7" name="esmE" placeholder="Paytm" required>
        <input type="number" id="msaf8" name="esmF" placeholder="Spice Money" required>
        <input type="number" id="msaf9" name="esmG" placeholder="TU" required>

        <input type="hidden" name="Timestamp" id="timestamp">

        <input type="submit" id="submitButton" value="Submit">
 </form>

 <H3 style="background-color: #004d80;color: WHITE;font-size: 100%; text-align: center;">Entry Modify</H3>

          <!-- Form for Fetching and Modifying Entries -->
    <form id="modifyBANKForm">
        <input type="number" id="searchSNo" placeholder="Enter S.No. to Modify Entry" >
        <button type="button"   onclick="fetchBANKDetails()">Fetch Details</button>
        <button type="button"  id="modifyBANKButton" onclick="modifyBANKEntry()" style="display:none;">Modify Entry</button>
        <div id="waitMessage" style="display:none; color:red; font-size:16px; font-weight:bold;"></div>
    </form>

    

   
    </div>
  `,
  voucher: `
    <div>
     
 <form id="mainVCRForm">
        <input type="hidden" name="SNo" id="sNo">
        
        <label for="type"></label>
        <select id="msaf11" name="Type" style="color: #04937d ;font-size:100%;" required>
            <option value="V">Voucher</option>
        </select>

        <label for="voucher"></label>
        <select id="msaf12" name="Voucher" required>
            <option value="" disabled selected>--Select Ledger--</option>
            <option value="MONEY TRANSFER">MONEY TRANSFER</option>
            <option value="AEPS/MATM">AEPS/MATM</option>
            <option value="ONLINE TRAN./APPLY">ONLINE TRAN./APPLY</option>
            <option value="SALE">SALE</option>
            <option value="IRCTC">IRCTC</option>
        </select>

        <label for="description">Description:</label>
        <input type="text" id="msaf13" name="esmA" placeholder="Description" required>

        <label for="charge">Com./Crg.:</label>
        <input type="number" id="msaf14" name="esmB" placeholder="Com./Crg." required>

        <label for="dr">DR. (‡§â‡§ß‡§æ‡§∞):</label>
        <input type="text" id="msaf15" name="esmC" placeholder="DR. (‡§â‡§ß‡§æ‡§∞)">

        <label for="amount">T. AMT:</label>
        <input type="number" id="msaf16" name="esmD" placeholder="T. AMT" required>

        <input type="hidden" name="Timestamp" id="timestamp">

        <input type="submit" id="submitButton" value="Submit">

        <H3 style="background-color: #004d80;color: WHITE;font-size: 100%; text-align: center;">Entry Modify</H3>

        <form id="modifyVCRForm">
            <input type="number" id="searchSNo" placeholder="Enter S.No. to Modify Entry" >
            <button type="button" onclick="fetchVCRDetails()">Fetch Details</button>
            <button type="button" id="modifyVCRButton" onclick="modifyVCREntry()" style="display:none;">Modify Entry</button>
             <!-- Wait message div -->
<div id="waitVCRMessage" style="display:none; color:red; font-size:16px; font-weight:bold;"></div>
        </form>
    </form>
    

    <br/>
        <span style="color:rgb(129, 1, 1);font-size:130%;font-family:Magneto;">eS |</span> 
        <span style="color:#004d80;font-size:130%;font-family:Magneto;">MTally</span>
   
    </div>
  `,
  receipt: `
    <div>
     
 <form id="mainRCPTForm">
        <input type="hidden" name="SNo" id="sNo">
       

        <label for="type"></label>
        <select id="msaf41" name="Type" style="color: #0fb403 ;font-size:100%;" required>
            <option value="R">Receipt</option>
        </select>

        <label for="voucher">Voucher:</label>
        <select id="msaf42" name="Voucher" required>
            <option value="" disabled selected>--Select Voucher--</option>
            <option value="ADVANCE">ADVANCE</option>
            <option value="EXPENSES">EXPENSES</option>
            <option value="DR. (‡§â‡§ß‡§æ‡§∞)">DR. (‡§â‡§ß‡§æ‡§∞)</option>
            <option value="OTHER">OTHER</option>
        </select>

        <label for="description">Description:</label>
        <input type="text" id="msaf43" name="esmA" placeholder="Description" required>

        <label for="charge">Amount:</label>
        <input type="number" id="msaf44" name="esmB" placeholder="Amount" required>

        <input type="hidden" name="Timestamp" id="timestamp">

        <input type="submit" id="submitButton" value="Submit">


        <H3 style="background-color: #004d80;color: WHITE;font-size: 100%; text-align: center;">Entry Modify</H3>

         <!-- Form for Fetching and Modifying Entries -->
    <form id="modifyRCPTForm">
        <input type="number" id="searchSNo" placeholder="Enter S.No. to Modify Entry" >
        <button type="button" onclick="fetchRCPTDetails()">Fetch Details</button>
        <button type="button" id="modifyRCPTButton" onclick="modifyRCPTEntry()" style="display:none;">Modify Entry</button>

        <!-- Wait message div -->
<div id="waitRCPTMessage" style="display:none; color:red; font-size:16px; font-weight:bold;"></div>
    </form>

    </form>
    

   
    </div>
  `,
  payment: `
  <div>
    <form id="mainPYMTForm">
        <input type="hidden" name="SNo" id="sNo">
       

        <label for="type" ></label>
        <select id="msaf21" name="Type" style="color: #c32606 ;font-size:100%;">
            <option value="P">PAYMENT</option>
        </select>

        <label for="voucher">Voucher:</label>
        <select id="msaf22" name="Voucher" required>
            <option value="" disabled selected>--Select Voucher--</option>
            <option value="ADVANCE">ADVANCE</option>
            <option value="EXPENSES">EXPENSES</option>
            <option value="OTHER">OTHER</option>
        </select>

        <label for="description">Description:</label>
        <input type="text" id="msaf23" name="esmA" placeholder="Description" required>

        <label for="charge">Amount:</label>
        <input type="number" id="msaf24" name="esmB" placeholder="Amount" required>

        <input type="hidden" name="Timestamp" id="timestamp">

        <input type="submit" id="submitButton" value="Submit">

        <H3 style="background-color: #004d80;color: WHITE;font-size: 100%; text-align: center;">Entry Modify</H3>

         <!-- Form for Fetching and Modifying Entries -->
    <form id="modifyPYMTForm">
        <input type="number" id="searchSNo" placeholder="Enter S.No. to Modify Entry" >
        <button type="button" onclick="fetchPYMTDetails()">Fetch Details</button>
        <button type="button" id="modifyPYMTButton" onclick="modifyPYMTEntry()" style="display:none;">Modify Entry</button>
        <!-- Wait message div -->
<div id="waitPYMTMessage" style="display:none; color:red; font-size:16px; font-weight:bold;"></div>
    </form>

    </form>


    </div>
  `,
  journal: `
    <div>
     <form id="mainJNLForm">
        <input type="hidden" name="SNo" id="sNo">

       
        <select id="msaf31" name="Type" required>
            <option value="Dr">Dr.</option>
            <option value="Cr">Cr.</option>
        </select>

        <label for="voucher">Ledger:</label>
        <select id="msaf32" name="Voucher" required>
            <option value="" disabled selected>--Select Ledger--</option>
            <option value="SHAYAM">SHAYAM</option>
            <option value="LEDER CHACHA">LEDER CHACHA</option>
            <option value="OTHER">OTHER</option>
        </select>

        <label for="description">Description:</label>
        <input type="text" id="msaf33" name="esmA" placeholder="Description" required>

        <label for="charge">Amount:</label>
        <input type="number" id="msaf34" name="esmB" placeholder="Amount" required>

        <input type="hidden" name="Timestamp" id="timestamp">

        <input type="submit" id="submitButton" value="Submit">

        <H3 style="background-color: #004d80;color: WHITE;font-size: 100%; text-align: center;">Entry Modify</H3>

         <!-- Form for Fetching and Modifying Entries -->
    <form id="modifyJNLForm">
        <input type="number" id="searchSNo" placeholder="Enter S.No. to Modify Entry" >
        <button type="button" onclick="fetchJNLDetails()">Fetch Details</button>
        <button type="button" id="modifyJNLButton" onclick="modifyJNLEntry()" style="display:none;">Modify Entry</button>
         <!-- Wait message div -->
<div id="waitJNLMessage" style="display:none; color:red; font-size:16px; font-weight:bold;"></div>
    </form>


    </form>
    </div>
  `
};

      

      document.getElementById("formTitle").innerText = titleMap[type];
      document.getElementById("formContent").innerHTML = contentMap[type];
      document.getElementById("formContainer").style.display = "block";
      document.getElementById("dropdownMenu").style.display = "none";

      // ‚úÖ Fetch ledgers AFTER form content is in DOM
      fetchData();
    }

    function closeForm() {
      document.getElementById("formContainer").style.display = "none";
    }

    // Optional: Close dropdown when clicking outside
    document.addEventListener("click", function (event) {
      const floatingdropdown = document.getElementById("dropdownMenu");
      const btn = document.querySelector(".floating-btn");
      if (!floatingdropdown.contains(event.target) && !btn.contains(event.target)) {
        floatingdropdown.style.display = "none";
      }
    });
  </script>
</body>
</html>









<!-- BANKING form div script start hare -->
<script>
  const scriptBANKURL = 'https://script.google.com/macros/s/AKfycbzo65ZpfIqjnCuHmHvek881hsmO0f8loZBZB8snBTLNd_sIGCXe8tnoi8lb7hXw_9QoPQ/exec';

  document.addEventListener("submit", async function (e) {
    const form = e.target;
    if (form.id !== "mainBANKForm") return;

    e.preventDefault();
    const submitButton = document.getElementById("submitButton");
    submitButton.disabled = true;
    submitButton.value = "Wait..";

    const now = new Date();
    document.getElementById('timestamp').value = `${now.getMonth()+1}/${now.getDate()}/${now.getFullYear()} ${now.getHours()}:${now.getMinutes()}:${now.getSeconds()}`;

    const formInputs = form.querySelectorAll('input, textarea');
    formInputs.forEach(input => {
      if (input.type === 'text' || input.type === 'textarea') {
        input.value = input.value.toUpperCase();
      }
    });

    const formData = new FormData(form);
    try {
      const response = await fetch(scriptBANKURL, { method: 'POST', body: formData });
      const result = await response.json();

      if (result.result === 'success') {
        alert('Entry saved successfully!');
        window.location.reload();
      } else {
        alert(`Error: ${result.error || 'Unknown error occurred.'}`);
      }
    } catch (error) {
      alert(`Error submitting the form: ${error.message}`);
    } finally {
      submitButton.disabled = false;
      submitButton.value = "Submit";
    }
  });

  async function fetchBANKDetails() {
    const sNo = document.getElementById("searchSNo").value;
    const waitMessage = document.getElementById("waitMessage");
    waitMessage.innerText = "Fetching data... Please wait...";
    waitMessage.style.display = 'block';

    try {
      const response = await fetch(`${scriptBANKURL}?sNo=${sNo}`);
      const data = await response.json();

      if (data.result !== "error" && data.Type === "B") {
        document.getElementById("sNo").value = data.SNo;
        document.getElementById("msaf1").value = data.Type;
        document.getElementById("msaf2").value = data.Voucher;
        document.getElementById("msaf3").value = data.esmA;
        document.getElementById("msaf4").value = data.esmB;
        document.getElementById("msaf5").value = data.esmC;
        document.getElementById("msaf6").value = data.esmD;
        document.getElementById("msaf7").value = data.esmE;
        document.getElementById("msaf8").value = data.esmF;
        document.getElementById("msaf9").value = data.esmG;
        document.getElementById("modifyBANKButton").style.display = "inline-block";
      } else {
        alert("No record found for the given S.No. with Type 'B'.");
      }
    } catch (error) {
      console.error("Error fetching details:", error);
      alert("Please reconcile details or contact admin.");
    } finally {
      setTimeout(() => waitMessage.style.display = 'none', 2000);
    }
  }

  async function modifyBANKEntry() {
    const formData = new FormData(document.getElementById('mainBANKForm'));
    formData.set('SNo', document.getElementById('sNo').value);

    const response = await fetch(scriptBANKURL, { method: 'POST', body: formData });
    const result = await response.json();

    if (result.result === 'success') {
      alert('Entry modified successfully!');
      window.location.reload();
    } else {
      alert(`Error modifying entry: ${result.error}`);
    }
  }
</script>
<!-- BANKING form div script stop hare -->




<!-- VOUCHER form div script start hare -->
<script>
  const scriptVCRURL = 'https://script.google.com/macros/s/AKfycbzo65ZpfIqjnCuHmHvek881hsmO0f8loZBZB8snBTLNd_sIGCXe8tnoi8lb7hXw_9QoPQ/exec';

  document.addEventListener("submit", async function (e) {
    const form = e.target;
    if (form.id !== "mainVCRForm") return;

    e.preventDefault();
    const submitButton = document.getElementById("submitButton");
    submitButton.disabled = true;
    submitButton.value = "Wait..";

    const now = new Date();
    document.getElementById('timestamp').value = `${now.getMonth()+1}/${now.getDate()}/${now.getFullYear()} ${now.getHours()}:${now.getMinutes()}:${now.getSeconds()}`;

    const formInputs = form.querySelectorAll('input, textarea');
    formInputs.forEach(input => {
      if (input.type === 'text' || input.type === 'textarea') {
        input.value = input.value.toUpperCase();
      }
    });

    const formData = new FormData(form);
    try {
      const response = await fetch(scriptVCRURL, { method: 'POST', body: formData });
      const result = await response.json();

      if (result.result === 'success') {
        alert('Entry saved successfully!');
        window.location.reload();
      } else {
        alert(`Error: ${result.error || 'Unknown error occurred.'}`);
      }
    } catch (error) {
      alert(`Error submitting the form: ${error.message}`);
    } finally {
      submitButton.disabled = false;
      submitButton.value = "Submit";
    }
  });

  async function fetchVCRDetails() {
    const sNo = document.getElementById("searchSNo").value;
    const waitMessage = document.getElementById("waitVCRMessage");
    waitMessage.innerText = "Fetching data... Please wait...";
    waitMessage.style.display = 'block';

    try {
      const response = await fetch(`${scriptVCRURL}?sNo=${sNo}`);
      const data = await response.json();

      if (data.result !== "error" && data.Type === "V") {
        document.getElementById("sNo").value = data.SNo;
        document.getElementById("msaf11").value = data.Type;
        document.getElementById("msaf12").value = data.Voucher;
        document.getElementById("msaf13").value = data.esmA;
        document.getElementById("msaf14").value = data.esmB;
        document.getElementById("msaf15").value = data.esmC;
        document.getElementById("msaf16").value = data.esmD;
        document.getElementById("modifyVCRButton").style.display = "inline-block";
      } else {
        alert("No record found for the given S.No. with Type 'V'.");
      }
    } catch (error) {
      console.error("Error fetching details:", error);
      alert("Please reconcile details or contact admin.");
    } finally {
      setTimeout(() => waitMessage.style.display = 'none', 2000);
    }
  }

  async function modifyVCREntry() {
    const formData = new FormData(document.getElementById('mainVCRForm'));
    formData.set('SNo', document.getElementById('sNo').value);

    const response = await fetch(scriptVCRURL, { method: 'POST', body: formData });
    const result = await response.json();

    if (result.result === 'success') {
      alert('Entry modified successfully!');
      window.location.reload();
    } else {
      alert(`Error modifying entry: ${result.error}`);
    }
  }
</script>
<!-- VOUCHER form div script stop hare -->





<!-- payment form div script start hare -->
<script>
  const scriptPYMTURL = 'https://script.google.com/macros/s/AKfycbzo65ZpfIqjnCuHmHvek881hsmO0f8loZBZB8snBTLNd_sIGCXe8tnoi8lb7hXw_9QoPQ/exec';

  document.addEventListener("submit", async function (e) {
    const form = e.target;
    if (form.id !== "mainPYMTForm") return;

    e.preventDefault();
    const submitButton = document.getElementById("submitButton");
    submitButton.disabled = true;
    submitButton.value = "Wait..";

    const now = new Date();
    document.getElementById('timestamp').value = `${now.getMonth()+1}/${now.getDate()}/${now.getFullYear()} ${now.getHours()}:${now.getMinutes()}:${now.getSeconds()}`;

    const formInputs = form.querySelectorAll('input, textarea');
    formInputs.forEach(input => {
      if (input.type === 'text' || input.type === 'textarea') {
        input.value = input.value.toUpperCase();
      }
    });

    const formData = new FormData(form);
    try {
      const response = await fetch(scriptPYMTURL, { method: 'POST', body: formData });
      const result = await response.json();

      if (result.result === 'success') {
        alert('Entry saved successfully!');
        window.location.reload();
      } else {
        alert(`Error: ${result.error || 'Unknown error occurred.'}`);
      }
    } catch (error) {
      alert(`Error submitting the form: ${error.message}`);
    } finally {
      submitButton.disabled = false;
      submitButton.value = "Submit";
    }
  });

  async function fetchPYMTDetails() {
    const sNo = document.getElementById("searchSNo").value;
    const waitMessage = document.getElementById("waitPYMTMessage");
    waitMessage.innerText = "Fetching data... Please wait...";
    waitMessage.style.display = 'block';

    try {
      const response = await fetch(`${scriptPYMTURL}?sNo=${sNo}`);
      const data = await response.json();

      if (data.result !== "error" && data.Type === "P") {
        document.getElementById("sNo").value = data.SNo;
        document.getElementById("msaf21").value = data.Type;
        document.getElementById("msaf22").value = data.Voucher;
        document.getElementById("msaf23").value = data.esmA;
        document.getElementById("msaf24").value = data.esmB;
        document.getElementById("modifyPYMTButton").style.display = "inline-block";
      } else {
        alert("No record found for the given S.No. with Type 'P'.");
      }
    } catch (error) {
      console.error("Error fetching details:", error);
      alert("Please reconcile details or contact admin.");
    } finally {
      setTimeout(() => waitMessage.style.display = 'none', 2000);
    }
  }

  async function modifyPYMTEntry() {
    const formData = new FormData(document.getElementById('mainPYMTForm'));
    formData.set('SNo', document.getElementById('sNo').value);

    const response = await fetch(scriptPYMTURL, { method: 'POST', body: formData });
    const result = await response.json();

    if (result.result === 'success') {
      alert('Entry modified successfully!');
      window.location.reload();
    } else {
      alert(`Error modifying entry: ${result.error}`);
    }
  }
</script>
<!-- payment form div script stop hare -->







<!-- journal form div script start hare -->
<script>
  const scriptJNLURL = 'https://script.google.com/macros/s/AKfycbzo65ZpfIqjnCuHmHvek881hsmO0f8loZBZB8snBTLNd_sIGCXe8tnoi8lb7hXw_9QoPQ/exec';

  document.addEventListener("submit", async function (e) {
    const form = e.target;
    if (form.id !== "mainJNLForm") return;

    e.preventDefault();
    const submitButton = document.getElementById("submitButton");
    submitButton.disabled = true;
    submitButton.value = "Wait..";

    const now = new Date();
    document.getElementById('timestamp').value = `${now.getMonth()+1}/${now.getDate()}/${now.getFullYear()} ${now.getHours()}:${now.getMinutes()}:${now.getSeconds()}`;

    const formInputs = form.querySelectorAll('input, textarea');
    formInputs.forEach(input => {
      if (input.type === 'text' || input.type === 'textarea') {
        input.value = input.value.toUpperCase();
      }
    });

    const formData = new FormData(form);
    try {
      const response = await fetch(scriptJNLURL, { method: 'POST', body: formData });
      const result = await response.json();

      if (result.result === 'success') {
        alert('Entry saved successfully!');
        window.location.reload();
      } else {
        alert(`Error: ${result.error || 'Unknown error occurred.'}`);
      }
    } catch (error) {
      alert(`Error submitting the form: ${error.message}`);
    } finally {
      submitButton.disabled = false;
      submitButton.value = "Submit";
    }
  });

  async function fetchJNLDetails() {
    const sNo = document.getElementById("searchSNo").value;
    const waitMessage = document.getElementById("waitJNLMessage");
    waitMessage.innerText = "Fetching data... Please wait...";
    waitMessage.style.display = 'block';

    try {
      const response = await fetch(`${scriptJNLURL}?sNo=${sNo}`);
      const data = await response.json();

      if (data.result !== "error" && data.Type === "Dr") {
        document.getElementById("sNo").value = data.SNo;
        document.getElementById("msaf31").value = data.Type;
        document.getElementById("msaf32").value = data.Voucher;
        document.getElementById("msaf33").value = data.esmA;
        document.getElementById("msaf34").value = data.esmB;
        document.getElementById("modifyJNLButton").style.display = "inline-block";
      } else {
        alert("No record found for the given S.No. with Type 'Dr'.");
      }
    } catch (error) {
      console.error("Error fetching details:", error);
      alert("Please reconcile details or contact admin.");
    } finally {
      setTimeout(() => waitMessage.style.display = 'none', 2000);
    }
  }

  async function modifyJNLEntry() {
    const formData = new FormData(document.getElementById('mainJNLForm'));
    formData.set('SNo', document.getElementById('sNo').value);

    const response = await fetch(scriptJNLURL, { method: 'POST', body: formData });
    const result = await response.json();

    if (result.result === 'success') {
      alert('Entry modified successfully!');
      window.location.reload();
    } else {
      alert(`Error modifying entry: ${result.error}`);
    }
  }
</script>
<!-- journal form div script stop hare -->






<!-- RECEIPT form div script start hare -->
<script>
  const scriptRCPTURL = 'https://script.google.com/macros/s/AKfycbzo65ZpfIqjnCuHmHvek881hsmO0f8loZBZB8snBTLNd_sIGCXe8tnoi8lb7hXw_9QoPQ/exec';

  document.addEventListener("submit", async function (e) {
    const form = e.target;
    if (form.id !== "mainRCPTForm") return;

    e.preventDefault();
    const submitButton = document.getElementById("submitButton");
    submitButton.disabled = true;
    submitButton.value = "Wait..";

    const now = new Date();
    document.getElementById('timestamp').value = `${now.getMonth()+1}/${now.getDate()}/${now.getFullYear()} ${now.getHours()}:${now.getMinutes()}:${now.getSeconds()}`;

    const formInputs = form.querySelectorAll('input, textarea');
    formInputs.forEach(input => {
      if (input.type === 'text' || input.type === 'textarea') {
        input.value = input.value.toUpperCase();
      }
    });

    const formData = new FormData(form);
    try {
      const response = await fetch(scriptRCPTURL, { method: 'POST', body: formData });
      const result = await response.json();

      if (result.result === 'success') {
        alert('Entry saved successfully!');
        window.location.reload();
      } else {
        alert(`Error: ${result.error || 'Unknown error occurred.'}`);
      }
    } catch (error) {
      alert(`Error submitting the form: ${error.message}`);
    } finally {
      submitButton.disabled = false;
      submitButton.value = "Submit";
    }
  });

  async function fetchRCPTDetails() {
    const sNo = document.getElementById("searchSNo").value;
    const waitMessage = document.getElementById("waitRCPTMessage");
    waitMessage.innerText = "Fetching data... Please wait...";
    waitMessage.style.display = 'block';

    try {
      const response = await fetch(`${scriptRCPTURL}?sNo=${sNo}`);
      const data = await response.json();

      if (data.result !== "error" && data.Type === "R") {
        document.getElementById("sNo").value = data.SNo;
        document.getElementById("msaf41").value = data.Type;
        document.getElementById("msaf42").value = data.Voucher;
        document.getElementById("msaf43").value = data.esmA;
        document.getElementById("msaf44").value = data.esmB;
        document.getElementById("modifyRCPTButton").style.display = "inline-block";
      } else {
        alert("No record found for the given S.No. with Type 'R'.");
      }
    } catch (error) {
      console.error("Error fetching details:", error);
      alert("Please reconcile details or contact admin.");
    } finally {
      setTimeout(() => waitMessage.style.display = 'none', 2000);
    }
  }

  async function modifyRCPTEntry() {
    const formData = new FormData(document.getElementById('mainRCPTForm'));
    formData.set('SNo', document.getElementById('sNo').value);

    const response = await fetch(scriptRCPTURL, { method: 'POST', body: formData });
    const result = await response.json();

    if (result.result === 'success') {
      alert('Entry modified successfully!');
      window.location.reload();
    } else {
      alert(`Error modifying entry: ${result.error}`);
    }
  }
</script>
<!-- RECEIPT form div script stop hare -->
<!-- floating DROPDOWN OPTION-btn WITH FORM FORM form div script STOP hare -->






<!-- AFI MEDICAL DIV CODE START HARE ...................................... -->


<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <title>ID | PASSWORD ESS</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: #f4f6f8;
        }

        /* üîç Search Bar */
        #searchAFIM {
            position: sticky;
            top: 0;
            background: #ffffff;
            padding: 10px;
            border-bottom: 2px solid #ccc;
            z-index: 1000;
        }
        #inputAFIMArea {
            padding: 10px;
            width: 100%;
            font-size: 15px;
            border: 2px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
        }

       

        /* üîµ Highlighted search text */
        .highlight {
            background-color: rgb(21, 215, 241);
            font-weight: bold;
        }

        /* üé® Row color types */
        tr.red td {
            background: #ffe5e5;
        }
        tr.blue td {
            background: #e6f0ff;
        }

        /* ü´• Hide row */
        tr.hidden {
            display: none;
        }

        /* üö´ No result message */
        #noResultsAFIMMessage {
            text-align: center;
            margin-top: 10px;
            font-weight: bold;
            color: #888;
        }

        /* ‚è≥ Loader */
        #loader {
            text-align: center;
            margin-top: 20px;
            font-size: 16px;
            color: #444;
        }
    </style>
</head>
<body>

  

    <!-- ‚è≥ Loader -->
    <div id="loader">‚è≥ Fetching data from Google Sheets...</div>

    <!-- üìã Data Table -->
    <table id="AFIMlTable"></table>



    <script>
        async function AFIM() {
            const apiAFIMKey = "AIzaSyBe-AlG9lpyXyC7KV-AavR6tbqOc75iYdM";
            const sheetAFIMId = "1C4EeSbCDaVGmJjU3QY2VNfI_IEZn0tZsqXw0ss3G58k";
            const rangeAFIM = 'AFIM!A:E';

            const loader = document.getElementById('loader');
            const table = document.getElementById('AFIMlTable');

            try {
                const response = await fetch(
                    `https://sheets.googleapis.com/v4/spreadsheets/${sheetAFIMId}/values/${rangeAFIM}?key=${apiAFIMKey}`
                );
                const data = await response.json();

                loader.textContent = ""; // remove loader

                if (data.values && data.values.length > 0) {
                    table.innerHTML = '';

                    data.values.forEach((row, index) => {
                        const tr = document.createElement('tr');

                        if (index === 0) {
                            // Header Row
                            row.forEach(cell => {
                                const th = document.createElement('th');
                                th.textContent = cell;
                                tr.appendChild(th);
                            });
                        } else {
                            // Data Rows
                            row.forEach((cell, cellIndex) => {
                                const td = document.createElement('td');

                                // If cell contains a link
                                if (typeof cell === 'string' && (cell.startsWith('http') || cell.startsWith('www'))) {
                                    const a = document.createElement('a');
                                    a.href = cell.startsWith('http') ? cell : `http://${cell}`;
                                    a.innerHTML = "&#128221; Click to View PO";
                                    a.target = "_blank";
                                    td.appendChild(a);
                                } else {
                                    td.textContent = cell;
                                }

                                // Colorize rows based on first column
                                if (cellIndex === 0) {
                                    if (cell.toLowerCase() === "credit note") tr.classList.add('blue');
                                    if (cell.toLowerCase() === "bank") tr.classList.add('red');
                                }

                                tr.appendChild(td);
                            });
                        }
                        table.appendChild(tr);
                    });
                } else {
                    loader.textContent = "‚ö†Ô∏è No data found in the sheet.";
                }
            } catch (error) {
                loader.textContent = "‚ùå Error fetching data from Google Sheets.";
                console.error(error);
            }
        }

        function serchAFIMProfile() {
            const query = document.getElementById('inputAFIMArea').value.toLowerCase();
            const table = document.getElementById('AFIMlTable');
            const rows = document.querySelectorAll('#AFIMlTable tr');
            let visibleRows = 0;

            rows.forEach((row, index) => {
                if (index === 0) return;

                row.querySelectorAll('td').forEach(cell => {
                    cell.innerHTML = cell.textContent;
                });

                if (query.trim() === '') {
                    row.classList.add('hidden');
                } else {
                    const rowText = Array.from(row.querySelectorAll('td'))
                        .map(cell => cell.textContent.toLowerCase())
                        .join(' ');

                    if (rowText.includes(query)) {
                        row.classList.remove('hidden');
                        visibleRows++;

                        // Highlight matching text
                        row.querySelectorAll('td').forEach(cell => {
                            const regex = new RegExp(`(${query})`, 'gi');
                            cell.innerHTML = cell.textContent.replace(regex, '<span class="highlight">$1</span>');
                        });
                    } else {
                        row.classList.add('hidden');
                    }
                }
            });

            // Show/hide no results message
            let msg = document.getElementById('noResultsAFIMMessage');
            if (!visibleRows && query.trim() !== '') {
                if (!msg) {
                    msg = document.createElement('p');
                    msg.id = 'noResultsAFIMMessage';
                    msg.textContent = 'No matching results found.';
                    document.body.appendChild(msg);
                }
            } else if (msg) {
                msg.remove();
            }

            // Show table only if visible rows
            table.style.display = visibleRows ? 'table' : 'none';
        }

        // ‚úÖ Safe DOM Load
        document.addEventListener("DOMContentLoaded", () => {
            document.getElementById('AFIMlTable').style.display = 'none';
            AFIM();
            document.getElementById('inputAFIMArea').addEventListener('input', serchAFIMProfile);
        });
    </script>
</body>
</html>



<!-- AFI MEDICAL DIV CODE STOP HARE ...................................... -->
